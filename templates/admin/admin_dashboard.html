{% extends "base.html" %}
{% block title %}Admin Dashboard{% endblock %}
{% block content %}
<div class="page-container admin-container">
    <div class="admin-header">
        <h2>Admin Dashboard</h2>
        <button id="add-movie-btn" class="action-btn">ï¼‹ Add New Movie</button>
    </div>

    <div id="add-movie-form-container" class="admin-form-container" style="display:none;">
        <h3>Add a New Movie</h3>
        <form action="{{ url_for('add_movie') }}" method="POST">
            <div class="form-grid">
                <input type="text" name="title" placeholder="Movie Title" required>
                <input type="number" step="0.1" name="rating" placeholder="Rating (e.g., 8.5)" required>
                <input type="number" name="duration" placeholder="Duration (minutes)" required>
                <input type="text" name="poster_url" placeholder="Poster Image URL" required>
                <textarea name="plot" placeholder="Movie Plot" required rows="4"></textarea>
            </div>
            <div class="form-actions">
                <button type="button" id="cancel-add-movie-btn" class="cancel-btn">Cancel</button>
                <button type="submit" class="action-btn">Save Movie</button>
            </div>
        </form>
    </div>

    <h3>Existing Movies</h3>
    <div class="movie-list-admin">
        <table>
            <thead>
                <tr>
                    <th>Poster</th>
                    <th>Title</th>
                    <th>Rating</th>
                    <th>Duration</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for movie in movies %}
                <tr>
                    <td><img src="{{ movie.poster_url }}" alt="Poster" class="admin-poster"></td>
                    <td>{{ movie.title }}</td>
                    <td>{{ movie.rating }}/10</td>
                    <td>{{ movie.duration_minutes }} min</td>
                    <td class="action-cell">
                        <a href="{{ url_for('manage_movie_page', movie_id=movie.id) }}" class="manage-btn">Manage</a>
                        <form action="{{ url_for('delete_movie', movie_id=movie.id) }}" method="POST" onsubmit="return confirm('Are you sure you want to delete this movie and all its showtimes?');">
                            <button type="submit" class="delete-btn">Delete</button>
                        </form>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}
{% block scripts %}
<script src="{{ url_for('static', filename='js/admin.js') }}"></script>
{% endblock %}